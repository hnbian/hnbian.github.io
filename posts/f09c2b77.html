<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Ambari 介绍 一、环境安装, hnbian">
    <meta name="description" content="1. Ambari 介绍Ambari 是 Apache Software Foundation 中的一个顶级项目。就 Ambari 的作用来说，就是创建、管理、监视 Hadoop 的集群，但是这里的 Hadoop 是广义，指的是 Hadoo">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-155985521-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', 'UA-155985521-1');
</script>


    <title>Ambari 介绍 一、环境安装 | hnbian</title>
    <link rel="icon" type="image/png" href="https://images.hnbian.cn/FvNSAGx7xljxALFh8Fa2DPNFP-JB">
    


    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 7.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="hnbian" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-okaidia.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="https://images.hnbian.cn/FvNSAGx7xljxALFh8Fa2DPNFP-JB" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">hnbian</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="https://images.hnbian.cn/FvNSAGx7xljxALFh8Fa2DPNFP-JB" class="logo-img circle responsive-img">
        
        <div class="logo-name">hnbian</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/hnbian" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/hnbian" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('https://images.hnbian.cn/FjyEghfHedrO-eZ5olryEvUMFXuj')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">Ambari 介绍 一、环境安装</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/ambari/">
                                <span class="chip bg-color">ambari</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/ambari/" class="post-category">
                                ambari
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2020-03-14
                </div>
                

                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h2 id="1-Ambari-介绍"><a href="#1-Ambari-介绍" class="headerlink" title="1. Ambari 介绍"></a>1. Ambari 介绍</h2><p><a target="_blank" rel="noopener" href="http://ambari.apache.org/">Ambari</a> 是 Apache Software Foundation 中的一个顶级项目。就 Ambari 的作用来说，就是创建、管理、监视 Hadoop 的集群，但是这里的 Hadoop 是广义，指的是 Hadoop 整个生态圈（例如 Hive，Hbase，Sqoop，Zookeeper 等），而并不仅是特指 Hadoop。用一句话来说，Ambari 就是为了让 Hadoop 以及相关的大数据软件更容易使用的一个工具。</p>
<h2 id="2-环境说明"><a href="#2-环境说明" class="headerlink" title="2. 环境说明"></a>2. 环境说明</h2><table>
<thead>
<tr>
<th>组件</th>
<th>版本</th>
</tr>
</thead>
<tbody><tr>
<td>Centos</td>
<td>7.5</td>
</tr>
<tr>
<td>Ambari</td>
<td>2.7.3</td>
</tr>
<tr>
<td>HDP</td>
<td>3.1.0.0</td>
</tr>
<tr>
<td>HDP-GPL</td>
<td>3.1.0.0</td>
</tr>
<tr>
<td>HDP-UTILS</td>
<td>1.1.0.22</td>
</tr>
<tr>
<td>MySQL</td>
<td>5.7</td>
</tr>
<tr>
<td>OracleJDK8</td>
<td>1.8.0_191-b12</td>
</tr>
<tr>
<td>X86</td>
<td>X86-64</td>
</tr>
</tbody></table>
<br>

<table>
<thead>
<tr>
<th>节点</th>
<th>部署服务</th>
</tr>
</thead>
<tbody><tr>
<td>hnode1</td>
<td>ambari server</td>
</tr>
<tr>
<td>hnode2</td>
<td>ambari agent</td>
</tr>
<tr>
<td>hnode3</td>
<td>ambari agent</td>
</tr>
</tbody></table>
<h2 id="3-安装集群时间同步服务（ntpd）"><a href="#3-安装集群时间同步服务（ntpd）" class="headerlink" title="3. 安装集群时间同步服务（ntpd）"></a>3. 安装集群时间同步服务（ntpd）</h2><p>三个节点上都要安装 </p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#安装时间同步服务（ntp）</span></span><br><span class="line">[root@hnode1 opt] yum install ntp</span><br><span class="line">Loaded plugins: fastestmirror, refresh-packagekit, security</span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line"> * base: ftp.sjtu.edu.cn</span><br><span class="line"> * extras: ap.stykers.moe</span><br><span class="line"> * updates: mirror.bit.edu.cn</span><br><span class="line"></span><br><span class="line"><span class="comment"># 强制从远程更新</span></span><br><span class="line">[root@hnode3 ~]# <span class="built_in">sudo</span> ntpdate 0.centos.pool.ntp.org</span><br><span class="line">28 Apr 15:54:51 ntpdate[75627]: step <span class="keyword">time</span> server 193.4.58.77 offset 2443633.848252 sec</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动服务</span></span><br><span class="line">[root@hnode1 opt] systemctl start ntpd.service</span><br><span class="line">[root@hnode1 opt]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查服务状态</span></span><br><span class="line">[root@hnode3 ~] systemctl status ntpd.service</span><br><span class="line">● ntpd.service - Network Time Service</span><br><span class="line">   Loaded: loaded (/usr/lib/systemd/system/ntpd.service; enabled; vendor preset: disabled)</span><br><span class="line">   Active: active (running) since 一 2020-03-30 16:26:16 CST; 37min ago</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置开机启动</span></span><br><span class="line">[root@hnode3 ~] systemctl <span class="built_in">enable</span> ntpd.service</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查开机启动是否设置成功</span></span><br><span class="line">[root@hnode3 ~]# systemctl is-enabled ntpd</span><br><span class="line">enabled</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<h2 id="4-关闭防火墙"><a href="#4-关闭防火墙" class="headerlink" title="4. 关闭防火墙"></a>4. 关闭防火墙</h2><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看防火墙状态</span></span><br><span class="line">[root@hnode1 ~] firewall-cmd --state</span><br><span class="line">running</span><br><span class="line">[root@hnode1 ~]</span><br><span class="line"><span class="comment"># 关闭防火墙</span></span><br><span class="line">[root@hnode1 ~] systemctl stop firewalld.service</span><br><span class="line">[root@hnode1 ~]</span><br><span class="line"><span class="comment"># 查看防火墙状态</span></span><br><span class="line">[root@hnode1 ~] firewall-cmd --state</span><br><span class="line">not running</span><br><span class="line">[root@hnode1 ~]</span><br><span class="line"><span class="comment"># 关闭防火墙开机启动</span></span><br><span class="line">[root@hnode1 ~] systemctl <span class="built_in">disable</span> firewalld.service</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>关闭 selinux</li>
</ul>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/selinux/config</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将 SELINUX=enforcing 修改为：</span></span><br><span class="line">SELINUX=disabled</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重启服务器后查看 SELINUX 状态</span></span><br><span class="line">[root@hnode1 ~]# sestatus</span><br><span class="line">SELinux status:                 disabled</span><br></pre></td></tr></tbody></table></figure>



<h2 id="5-设置免密登录"><a href="#5-设置免密登录" class="headerlink" title="5. 设置免密登录"></a>5. 设置免密登录</h2><p>设置免密登录，从hnode1 免密登录到hnode2、hnode3</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># home下创建.ssh目录</span></span><br><span class="line">[root@hnode1 ~] <span class="built_in">mkdir</span> .ssh</span><br><span class="line">[root@hnode1 ~] <span class="built_in">cd</span> .ssh/</span><br><span class="line">[root@hnode1 .ssh] <span class="built_in">pwd</span></span><br><span class="line">/root/.ssh</span><br><span class="line"><span class="comment"># 生成秘钥</span></span><br><span class="line">[root@hnode1 .ssh] ssh-keygen -t rsa</span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file <span class="keyword">in</span> <span class="built_in">which</span> to save the key (/root/.ssh/id_rsa): （回车）</span><br><span class="line">Enter passphrase (empty <span class="keyword">for</span> no passphrase):（回车）</span><br><span class="line">Enter same passphrase again:（回车）</span><br><span class="line">Your identification has been saved <span class="keyword">in</span> /root/.ssh/id_rsa.</span><br><span class="line">Your public key has been saved <span class="keyword">in</span> /root/.ssh/id_rsa.pub.</span><br><span class="line">The key fingerprint is:</span><br><span class="line">SHA256:F1XLKMmnivY288gcK5IsY90xm0kawlM62D+uyGIeB0k root@hnode1</span><br><span class="line">The keys randomart image is:</span><br><span class="line">+---[RSA 2048]----+</span><br><span class="line">|            ...  |</span><br><span class="line">|         . o o . |</span><br><span class="line">| E        = o o  |</span><br><span class="line">|. . .      =     |</span><br><span class="line">| * o    S o      |</span><br><span class="line">|. O . +. o       |</span><br><span class="line">| . O *o*o        |</span><br><span class="line">|oo* O.*+++       |</span><br><span class="line">|=+.=.o o*+.      |</span><br><span class="line">+----[SHA256]-----+</span><br><span class="line"><span class="comment"># 查看生成的文件</span></span><br><span class="line">[root@hnode1 .ssh] ll</span><br><span class="line">总用量 8</span><br><span class="line">-rw-------. 1 root root 1675 3月  30 18:58 id_rsa</span><br><span class="line">-rw-r--r--. 1 root root  393 3月  30 18:58 id_rsa.pub</span><br><span class="line"></span><br><span class="line">[root@hnode1 .ssh]</span><br><span class="line"></span><br><span class="line"><span class="comment">#将公钥拷贝到hnode2、hnode3</span></span><br><span class="line">[root@hnode1 .ssh] ssh-copy-id hnode2</span><br><span class="line">...</span><br><span class="line">root@hnode2s password: <span class="comment"># (输入hnode2的密码)</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">[root@hnode1 .ssh]</span><br><span class="line"><span class="comment"># 尝试登陆hnode2</span></span><br><span class="line">[root@hnode1 .ssh] ssh hnode2</span><br><span class="line">Last login: Mon Mar 30 18:32:21 2020 from hnode1 <span class="comment"># 登陆成功</span></span><br><span class="line">Last login: Mon Mar 30 18:32:21 2020 from hnode1</span><br><span class="line"><span class="comment"># 登出</span></span><br><span class="line">[root@hnode2 ~] <span class="built_in">exit</span></span><br><span class="line">Connection to hnode2 closed.</span><br><span class="line"></span><br><span class="line"><span class="comment">#将秘钥拷贝到hnode3</span></span><br><span class="line">[root@hnode1 .ssh] ssh-copy-id hnode3</span><br><span class="line">...</span><br><span class="line">root@hnode3s password: <span class="comment"># (输入hnode3的密码)</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">[root@hnode1 .ssh] ssh hnode3</span><br><span class="line">Last login: Mon Mar 30 17:50:57 2020 from hnode1</span><br><span class="line"><span class="comment"># 登出</span></span><br><span class="line">[root@hnode3 ~] <span class="built_in">exit</span></span><br><span class="line">Connection to hnode3 closed.</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p><img src="https://images.hnbian.cn/FibfUAY6fojeMM0yABALNY9lsbzy?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="免密登录大致原理"></p>
<h2 id="6-安装Java"><a href="#6-安装Java" class="headerlink" title="6. 安装Java"></a>6. 安装Java</h2><p>三个节点上都要安装</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 解压安装包</span></span><br><span class="line">[root@hnode1 jdk1.8.0_191] tar -zxvf jdk-8u191-linux-x64.tar.gz</span><br><span class="line">root@hnode1 opt] <span class="built_in">cd</span> jdk1.8.0_191/</span><br><span class="line">[root@hnode1 jdk1.8.0_191] ll</span><br><span class="line">总用量 25976</span><br><span class="line">drwxr-xr-x. 2 10 143     4096 10月  6 2018 bin</span><br><span class="line">-r--r--r--. 1 10 143     3244 10月  6 2018 COPYRIGHT</span><br><span class="line">drwxr-xr-x. 3 10 143      132 10月  6 2018 include</span><br><span class="line">-rw-r--r--. 1 10 143  5207154 9月  12 2018 javafx-src.zip</span><br><span class="line">drwxr-xr-x. 5 10 143      185 10月  6 2018 jre</span><br><span class="line">drwxr-xr-x. 5 10 143      245 10月  6 2018 lib</span><br><span class="line">-r--r--r--. 1 10 143       40 10月  6 2018 LICENSE</span><br><span class="line">drwxr-xr-x. 4 10 143       47 10月  6 2018 man</span><br><span class="line">-r--r--r--. 1 10 143      159 10月  6 2018 README.html</span><br><span class="line">-rw-r--r--. 1 10 143      424 10月  6 2018 release</span><br><span class="line">-rw-r--r--. 1 10 143 21101479 10月  6 2018 src.zip</span><br><span class="line">-rw-r--r--. 1 10 143   108062 9月  12 2018 THIRDPARTYLICENSEREADME-JAVAFX.txt</span><br><span class="line">-r--r--r--. 1 10 143   155003 10月  6 2018 THIRDPARTYLICENSEREADME.txt</span><br><span class="line">[root@hnode1 jdk1.8.0_191] <span class="built_in">pwd</span></span><br><span class="line">/opt/jdk1.8.0_191</span><br><span class="line">[root@hnode1 jdk1.8.0_191]</span><br><span class="line"><span class="comment"># 配置环境变量</span></span><br><span class="line">[root@hnode1 jdk1.8.0_191] vim /etc/profile</span><br><span class="line"></span><br><span class="line"><span class="comment"># 文件底部增加如下配置</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># jdk 安装地址</span></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/opt/jdk1.8.0_191</span><br><span class="line"></span><br><span class="line">PATH=<span class="variable">$PATH</span>:<span class="variable">$JAVA_HOME</span>/bin</span><br><span class="line"></span><br><span class="line"><span class="comment"># 刷新配置文件</span></span><br><span class="line">[root@hnode1 jdk1.8.0_191] <span class="built_in">source</span> /etc/profile</span><br><span class="line"><span class="comment"># 打印Java home</span></span><br><span class="line">[root@hnode1 jdk1.8.0_191] <span class="built_in">echo</span> <span class="variable">$JAVA_HOME</span></span><br><span class="line">/opt/jdk1.8.0_191</span><br><span class="line"><span class="comment"># 查看 java 版本进行验证</span></span><br><span class="line">[root@hnode1 jdk1.8.0_191] java -version</span><br><span class="line"><span class="comment"># 打印除下列 java 版本信息 说明jdk安装成功</span></span><br><span class="line">java version <span class="string">"1.8.0_191"</span></span><br><span class="line">Java(TM) SE Runtime Environment (build 1.8.0_191-b12)</span><br><span class="line">Java HotSpot(TM) 64-Bit Server VM (build 25.191-b12, mixed mode)</span><br></pre></td></tr></tbody></table></figure>



<h2 id="7-安装MySQL"><a href="#7-安装MySQL" class="headerlink" title="7. 安装MySQL"></a>7. 安装MySQL</h2><h3 id="7-1-下载MySQL"><a href="#7-1-下载MySQL" class="headerlink" title="7.1 下载MySQL"></a>7.1 下载MySQL</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载 MySQL</span></span><br><span class="line">[root@hnode1 opt] wget -i -c http://dev.mysql.com/get/mysql57-community-release-el7-10.noarch.rpm</span><br><span class="line">--2020-03-30 19:35:18--  http://dev.mysql.com/get/mysql57-community-release-el7-10.noarch.rpm</span><br><span class="line">正在解析主机 dev.mysql.com (dev.mysql.com)... 137.254.60.11</span><br><span class="line">正在连接 dev.mysql.com (dev.mysql.com)|137.254.60.11|:80... 已连接。</span><br><span class="line">已发出 HTTP 请求，正在等待回应... 301 Moved Permanently</span><br><span class="line">位置：https://dev.mysql.com/get/mysql57-community-release-el7-10.noarch.rpm [跟随至新的 URL]</span><br><span class="line">--2020-03-30 19:35:22--  https://dev.mysql.com/get/mysql57-community-release-el7-10.noarch.rpm</span><br><span class="line">正在连接 dev.mysql.com (dev.mysql.com)|137.254.60.11|:443... 已连接。</span><br><span class="line">已发出 HTTP 请求，正在等待回应... 302 Found</span><br><span class="line">位置：https://repo.mysql.com//mysql57-community-release-el7-10.noarch.rpm [跟随至新的 URL]</span><br><span class="line">--2020-03-30 19:35:30--  https://repo.mysql.com//mysql57-community-release-el7-10.noarch.rpm</span><br><span class="line">正在解析主机 repo.mysql.com (repo.mysql.com)... 223.119.236.209</span><br><span class="line">正在连接 repo.mysql.com (repo.mysql.com)|223.119.236.209|:443... 已连接。</span><br><span class="line">已发出 HTTP 请求，正在等待回应... 200 OK</span><br><span class="line">长度：25548 (25K) [application/x-redhat-package-manager]</span><br><span class="line">正在保存至: “mysql57-community-release-el7-10.noarch.rpm”</span><br><span class="line"></span><br><span class="line">100%[======================================================&gt;] 25,548      71.4KB/s 用时 0.3s</span><br><span class="line"></span><br><span class="line">2020-03-30 19:35:33 (71.4 KB/s) - 已保存 “mysql57-community-release-el7-10.noarch.rpm” [25548/25548])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装mysql </span></span><br><span class="line"></span><br><span class="line">yum -y install mysql57-community-release-el7-10.noarch.rpm</span><br><span class="line">yum -y install mysql-community-server</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<h3 id="7-2-启动mysql并设置开机自启"><a href="#7-2-启动mysql并设置开机自启" class="headerlink" title="7.2 启动mysql并设置开机自启"></a>7.2 启动mysql并设置开机自启</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">systemctl start mysqld.service    <span class="comment"># 启动mysql</span></span><br><span class="line">systemctl status mysqld.service  <span class="comment"># 查看mysql状态</span></span><br><span class="line">systemctl stop mysqld.service   <span class="comment"># 关闭mysql</span></span><br><span class="line">systemctl <span class="built_in">enable</span> mysqld.service   <span class="comment"># 开机自启</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="7-3-配置mysql编码，字符格式："><a href="#7-3-配置mysql编码，字符格式：" class="headerlink" title="7.3 配置mysql编码，字符格式："></a>7.3 配置mysql编码，字符格式：</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@hnode1 opt] vim /etc/my.cnf </span><br><span class="line"></span><br><span class="line"><span class="comment"># 文件底部添加下面代码</span></span><br><span class="line"></span><br><span class="line">log-error=/var/log/mysqld.log</span><br><span class="line">pid-file=/var/run/mysqld/mysqld.pid</span><br><span class="line">collation_server=utf8_general_ci</span><br><span class="line">character_set_server=utf8</span><br><span class="line">default-storage-engine=INNODB</span><br></pre></td></tr></tbody></table></figure>

<h3 id="7-4-运行mysql-安全配置向导"><a href="#7-4-运行mysql-安全配置向导" class="headerlink" title="7.4 运行mysql 安全配置向导"></a>7.4 运行mysql 安全配置向导</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装之后的密码会存在/var/log/mysqld.log 文件中</span></span><br><span class="line"></span><br><span class="line">[root@hnode1 opt] <span class="built_in">cat</span> /var/log/mysqld.log</span><br><span class="line">2020-03-30T11:57:32.968090Z 0 [Warning] TIMESTAMP ...</span><br><span class="line">...</span><br><span class="line">2020-03-30T11:57:33.657151Z 1 [Note] A temporary password is generated <span class="keyword">for</span> root@localhost: o6)j!d;l&gt;iQz</span><br><span class="line"></span><br><span class="line">(o6)j!d;l&gt;iQz) <span class="comment"># 就是 MySQL 的初始密码</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@hnode1 opt] mysql_secure_installation</span><br><span class="line"></span><br><span class="line">Securing the MySQL server deployment.</span><br><span class="line"></span><br><span class="line">Enter password <span class="keyword">for</span> user root: <span class="comment"># 刚刚查询到的MySQL初始密码(o6)j!d;l&gt;iQz)</span></span><br><span class="line"></span><br><span class="line">The existing password <span class="keyword">for</span> the user account root has expired. Please <span class="built_in">set</span> a new password.</span><br><span class="line"></span><br><span class="line">New password: <span class="comment"># 新的密码 （Admin123!）</span></span><br><span class="line"></span><br><span class="line">Re-enter new password: <span class="comment"># 新的密码</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">By default, a MySQL installation has an anonymous user,</span><br><span class="line">allowing anyone to <span class="built_in">log</span> into MySQL without having to have</span><br><span class="line">a user account created <span class="keyword">for</span> them. This is intended only <span class="keyword">for</span></span><br><span class="line">testing, and to make the installation go a bit smoother.</span><br><span class="line">You should remove them before moving into a production</span><br><span class="line">environment.</span><br><span class="line"></span><br><span class="line">Remove anonymous <span class="built_in">users</span>? (Press y|Y <span class="keyword">for</span> Yes, any other key <span class="keyword">for</span> No) : y <span class="comment">#是否删除匿名用户,生产环境建议删除</span></span><br><span class="line">Success.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Normally, root should only be allowed to connect from</span><br><span class="line"><span class="string">'localhost'</span>. This ensures that someone cannot guess at</span><br><span class="line">the root password from the network.</span><br><span class="line"></span><br><span class="line">Disallow root login remotely? (Press y|Y <span class="keyword">for</span> Yes, any other key <span class="keyword">for</span> No) : n <span class="comment">#是否禁止root远程登录,根据自己的需求选择y/n并回车</span></span><br><span class="line"></span><br><span class="line"> ... skipping.</span><br><span class="line">By default, MySQL comes with a database named <span class="string">'test'</span> that</span><br><span class="line">anyone can access. This is also intended only <span class="keyword">for</span> testing,</span><br><span class="line">and should be removed before moving into a production</span><br><span class="line">environment.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Remove <span class="built_in">test</span> database and access to it? (Press y|Y <span class="keyword">for</span> Yes, any other key <span class="keyword">for</span> No) : n <span class="comment">#是否删除test数据库</span></span><br><span class="line"></span><br><span class="line"> ... skipping.</span><br><span class="line">Reloading the privilege tables will ensure that all changes</span><br><span class="line">made so far will take effect immediately.</span><br><span class="line"></span><br><span class="line">Reload privilege tables now? (Press y|Y <span class="keyword">for</span> Yes, any other key <span class="keyword">for</span> No) : y <span class="comment">#是否重新加载权限表</span></span><br><span class="line">Success.</span><br><span class="line"></span><br><span class="line">All <span class="keyword">done</span>!</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<h3 id="7-5-测试连接MySQL"><a href="#7-5-测试连接MySQL" class="headerlink" title="7.5 测试连接MySQL"></a>7.5 测试连接MySQL</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 命令行中连接MySQL</span></span><br><span class="line">[root@hnode1 opt] mysql -u root -p</span><br><span class="line">Enter password: （Admin123!）</span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection <span class="built_in">id</span> is 9</span><br><span class="line">Server version: 5.7.29 MySQL Community Server (GPL)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2020, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type <span class="string">'help;'</span> or <span class="string">'\h'</span> <span class="keyword">for</span> <span class="built_in">help</span>. Type <span class="string">'\c'</span> to clear the current input statement.</span><br><span class="line"></span><br><span class="line">mysql&gt; show databases</span><br><span class="line">    -&gt; ;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">+--------------------+</span><br><span class="line">4 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; quit</span><br><span class="line">Bye</span><br></pre></td></tr></tbody></table></figure>


<h3 id="7-6-在mysql数据库创建相应的用户和DB"><a href="#7-6-在mysql数据库创建相应的用户和DB" class="headerlink" title="7.6 在mysql数据库创建相应的用户和DB"></a>7.6 在mysql数据库创建相应的用户和DB</h3><h4 id="7-6-1-创建ambari数据库及数据库的用户名和密码"><a href="#7-6-1-创建ambari数据库及数据库的用户名和密码" class="headerlink" title="7.6.1 创建ambari数据库及数据库的用户名和密码"></a>7.6.1 创建ambari数据库及数据库的用户名和密码</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="built_in">set</span> global validate_password_policy=0;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="built_in">set</span> global validate_password_length=1;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; create database ambari character <span class="built_in">set</span> utf8;</span><br><span class="line">Query OK, 1 row affected (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; CREATE USER <span class="string">'ambari'</span>@<span class="string">'%'</span>IDENTIFIED BY <span class="string">'Ambari123'</span>;</span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; GRANT ALL PRIVILEGES ON ambari.* TO <span class="string">'ambari'</span>@<span class="string">'%'</span>;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; FLUSH PRIVILEGES;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br></pre></td></tr></tbody></table></figure>

<h4 id="7-6-2-创建hive数据库及hive库的用户名和密码"><a href="#7-6-2-创建hive数据库及hive库的用户名和密码" class="headerlink" title="7.6.2 创建hive数据库及hive库的用户名和密码"></a>7.6.2 创建hive数据库及hive库的用户名和密码</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; create database hive character <span class="built_in">set</span> utf8;</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; CREATE USER <span class="string">'hive'</span>@<span class="string">'%'</span>IDENTIFIED BY <span class="string">'Hive123'</span>;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; GRANT ALL PRIVILEGES ON hive.* TO <span class="string">'hive'</span>@<span class="string">'%'</span>;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; FLUSH PRIVILEGES;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br></pre></td></tr></tbody></table></figure>

<h4 id="7-6-3-创建oozie数据库及oozie库的用户名和密码"><a href="#7-6-3-创建oozie数据库及oozie库的用户名和密码" class="headerlink" title="7.6.3 创建oozie数据库及oozie库的用户名和密码"></a>7.6.3 创建oozie数据库及oozie库的用户名和密码</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; create database oozie character <span class="built_in">set</span> utf8;</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; CREATE USER <span class="string">'oozie'</span>@<span class="string">'%'</span>IDENTIFIED BY <span class="string">'Oozie123'</span>;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; GRANT ALL PRIVILEGES ON oozie.* TO <span class="string">'oozie'</span>@<span class="string">'%'</span>;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; FLUSH PRIVILEGES;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br></pre></td></tr></tbody></table></figure>

<h4 id="7-6-4-创建ranger数据库及ranger库的用户名和密码（不用创建）"><a href="#7-6-4-创建ranger数据库及ranger库的用户名和密码（不用创建）" class="headerlink" title="7.6.4 创建ranger数据库及ranger库的用户名和密码（不用创建）"></a>7.6.4 创建ranger数据库及ranger库的用户名和密码（不用创建）</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; create database ranger character <span class="built_in">set</span> utf8;</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; CREATE USER <span class="string">'rangeradmin'</span>@<span class="string">'%'</span>IDENTIFIED BY <span class="string">'Ranger123'</span>;</span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; GRANT ALL PRIVILEGES ON rangeradmin.* TO <span class="string">'rangeradmin'</span>@<span class="string">'%'</span>;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; FLUSH PRIVILEGES;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br><span class="line">mysql&gt; show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| ambari             |</span><br><span class="line">| hive               |</span><br><span class="line">| mysql              |</span><br><span class="line">| oozie              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| ranger             |</span><br><span class="line">| sys                |</span><br><span class="line">+--------------------+</span><br><span class="line">8 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.01 sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<h4 id="7-6-5-下载mysql-connection-java"><a href="#7-6-5-下载mysql-connection-java" class="headerlink" title="7.6.5 下载mysql-connection-java"></a>7.6.5 下载mysql-connection-java</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[root@hnode1 ~] yum install mysql-connector-java</span><br><span class="line">已加载插件：fastestmirror</span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line"> * base: mirrors.aliyun.com</span><br><span class="line"> * extras: mirrors.aliyun.com</span><br><span class="line">...</span><br><span class="line">完毕！</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查文件是否存在</span></span><br><span class="line"></span><br><span class="line">[root@hnode1 ~] <span class="built_in">ls</span> /usr/share/java</span><br><span class="line">mysql-connector-java.jar</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<h3 id="7-7-下载所需安装文件"><a href="#7-7-下载所需安装文件" class="headerlink" title="7.7 下载所需安装文件"></a>7.7 下载所需安装文件</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">wget http://public-repo-1.hortonworks.com/ambari/centos7/2.x/updates/2.7.3.0/ambari-2.7.3.0-centos7.tar.gz</span><br><span class="line"></span><br><span class="line">wget http://public-repo-1.hortonworks.com/HDP/centos7/3.x/updates/3.1.0.0/HDP-3.1.0.0-centos7-rpm.tar.gz</span><br><span class="line"></span><br><span class="line">wget http://public-repo-1.hortonworks.com/HDP-UTILS-1.1.0.22/repos/centos7/HDP-UTILS-1.1.0.22-centos7.tar.gz</span><br><span class="line"></span><br><span class="line"><span class="comment">#查看下载好的文件</span></span><br><span class="line"></span><br><span class="line">[root@hnode1 opt] ll -rth</span><br><span class="line">-rw-r--r--. 1 root root  87M 3月  30 21:50 HDP-UTILS-1.1.0.22-centos7.tar.gz</span><br><span class="line">-rw-r--r--. 1 root root 1.9G 3月  30 21:51 ambari-2.7.3.0-centos7.tar.gz</span><br><span class="line">-rw-r--r--. 1 root root 8.5G 3月  30 21:52 HDP-3.1.0.0-centos7-rpm.tar.gz</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>


<h2 id="8-安装yum相关工具"><a href="#8-安装yum相关工具" class="headerlink" title="8. 安装yum相关工具"></a>8. 安装yum相关工具</h2><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@hnode1 ~] yum install yum-utils -y</span><br><span class="line">[root@hnode1 ~] yum repolist</span><br><span class="line">[root@hnode1 ~] yum install createrepo -y</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<h2 id="9-安装Apache-httpd"><a href="#9-安装Apache-httpd" class="headerlink" title="9. 安装Apache httpd"></a>9. 安装Apache httpd</h2><h3 id="9-1-安装"><a href="#9-1-安装" class="headerlink" title="9.1  安装"></a>9.1  安装</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[root@hnode1 ~] yum install httpd -y</span><br><span class="line">已加载插件：fastestmirror</span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line">...</span><br><span class="line">完毕！</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装完成后，会生成 /var/www/html 目录（相当于Tomcat的webapps目录）</span></span><br><span class="line"><span class="comment"># 进入到/var/www/html目录下，创建ambari和hdp目录，用来存放安装文件。</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> /var/www/html</span><br><span class="line">[root@hnode1 html]</span><br><span class="line">总用量 0</span><br><span class="line">[root@hnode1 html] <span class="built_in">pwd</span></span><br><span class="line">/var/www/html</span><br><span class="line">[root@hnode1 html] <span class="built_in">mkdir</span> ambari</span><br><span class="line">[root@hnode1 html] <span class="built_in">mkdir</span> hdp</span><br><span class="line">[root@hnode1 html] <span class="built_in">mkdir</span> hdp/HDP-UTILS-1.1.0.22</span><br><span class="line">[root@hnode1 html]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将下载好的文件解压到对应目录</span></span><br><span class="line"></span><br><span class="line">tar -zxvf ambari-2.7.3.0-centos7.tar.gz -C /var/www/html/ambari/</span><br><span class="line">tar -zxvf HDP-3.1.0.0-centos7-rpm.tar.gz -C /var/www/html/hdp/</span><br><span class="line">tar -zxvf HDP-UTILS-1.1.0.22-centos7.tar.gz -C /var/www/html/hdp/HDP-UTILS-1.1.0.22/</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<h3 id="9-2-启动"><a href="#9-2-启动" class="headerlink" title="9.2 启动"></a>9.2 启动</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启动httpd</span></span><br><span class="line">[root@hnode1 html] systemctl start httpd</span><br><span class="line">[root@hnode1 html]</span><br><span class="line">[root@hnode1 html]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看httpd状态</span></span><br><span class="line">[root@hnode1 html] systemctl status httpd</span><br><span class="line">● httpd.service - The Apache HTTP Server</span><br><span class="line">   Loaded: loaded (/usr/lib/systemd/system/httpd.service; disabled; vendor preset: disabled)</span><br><span class="line">   Active: active (running) since 一 2020-03-30 20:46:31 CST; 6s ago</span><br><span class="line">     Docs: man:httpd(8)</span><br><span class="line">           man:apachectl(8)</span><br><span class="line"> Main PID: 1845 (httpd)</span><br><span class="line">   Status: <span class="string">"Processing requests..."</span></span><br><span class="line">   CGroup: /system.slice/httpd.service</span><br><span class="line">           ├─1845 /usr/sbin/httpd -DFOREGROUND</span><br><span class="line">           ├─1846 /usr/sbin/httpd -DFOREGROUND</span><br><span class="line">           ├─1847 /usr/sbin/httpd -DFOREGROUND</span><br><span class="line">           ├─1848 /usr/sbin/httpd -DFOREGROUND</span><br><span class="line">           ├─1849 /usr/sbin/httpd -DFOREGROUND</span><br><span class="line">           └─1850 /usr/sbin/httpd -DFOREGROUND</span><br><span class="line"></span><br><span class="line">3月 30 20:46:31 hnode1 systemd[1]: Starting The Apache HTTP Server...</span><br><span class="line">3月 30 20:46:31 hnode1 httpd[1845]: AH00558: httpd: Could not reliably determine the </span><br><span class="line">server<span class="string">'s fully qualified domain name, using ::1. Set the '</span>ServerName<span class="string">' directive globally to suppress this message</span></span><br><span class="line"><span class="string">3月 30 20:46:31 hnode1 systemd[1]: Started The Apache HTTP Server.</span></span><br><span class="line"><span class="string">[root@hnode1 html]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 设置httpd开机自启</span></span><br><span class="line"><span class="string">[root@hnode1 html] systemctl enable httpd</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="9-3-访问"><a href="#9-3-访问" class="headerlink" title="9.3 访问"></a>9.3 访问</h3><p>浏览器输入：<a target="_blank" rel="noopener" href="http://ip地址(默认端口80)/">http://ip地址（默认端口80）</a></p>
<p><img src="https://images.hnbian.cn/FhceKjJePliKeCWRpR7WsJtNlV2C?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="httpd 首页"></p>
<p><img src="https://images.hnbian.cn/Fq_xwGjK52_pQrl0P4XwdvynRJZ-?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="Ambari"></p>
<h2 id="10-配置本地-Repo"><a href="#10-配置本地-Repo" class="headerlink" title="10. 配置本地 Repo"></a>10. 配置本地 Repo</h2><h3 id="10-1-配置Ambari"><a href="#10-1-配置Ambari" class="headerlink" title="10.1 配置Ambari"></a>10.1 配置Ambari</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">wget -O /etc/yum.repos.d/ambari.repo http://public-repo-1.hortonworks.com/ambari/centos7/2.x/updates/2.7.3.0/ambari.repo</span><br><span class="line">...</span><br><span class="line">正在解析主机 public ...</span><br><span class="line">...</span><br><span class="line">100%[=================================================&gt;] 376         --.-K/s 用时 0s</span><br><span class="line"></span><br><span class="line">2020-03-30 22:20:10 (76.0 MB/s) - 已保存 “/etc/yum.repos.d/ambari.repo” [376/376])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改配置文件</span></span><br><span class="line">vim /etc/yum.repos.d/ambari.repo</span><br><span class="line"></span><br><span class="line"><span class="comment">#VERSION_NUMBER=2.7.3.0-139</span></span><br><span class="line">[ambari-2.7.3.0]</span><br><span class="line"><span class="comment">#json.url = http://public-repo-1.hortonworks.com/HDP/hdp_urlinfo.json</span></span><br><span class="line">name=ambari Version - ambari-2.7.3.0</span><br><span class="line"></span><br><span class="line"><span class="comment">#修改host 地址</span></span><br><span class="line">baseurl=http://hnode1/ambari/ambari/centos7/2.7.3.0-139</span><br><span class="line">gpgcheck=1</span><br><span class="line"></span><br><span class="line"><span class="comment">#修改host 地址</span></span><br><span class="line">gpgkey=http://hnode1/ambari/ambari/centos7/2.7.3.0-139/RPM-GPG-KEY/RPM-GPG-KEY-Jenkins</span><br><span class="line">enabled=1</span><br><span class="line">priority=1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 地址配置完成之后可以在浏览器里面检查一下是否能够正常访问</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<h3 id="10-2-配置HDP和HDP-UTILS"><a href="#10-2-配置HDP和HDP-UTILS" class="headerlink" title="10.2 配置HDP和HDP-UTILS"></a>10.2 配置HDP和HDP-UTILS</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建配置文件</span></span><br><span class="line">[root@hnode1 opt] vim /etc/yum.repos.d/ambari.repo</span><br><span class="line">[root@hnode1 opt]</span><br><span class="line">[root@hnode1 opt] <span class="built_in">ls</span> /etc/yum.repos.d/ | grep HDP.repo</span><br><span class="line">HDP.repo</span><br><span class="line"></span><br><span class="line"><span class="comment"># 文件内添加如下添加内容：</span></span><br><span class="line"></span><br><span class="line">[root@hnode1 opt] vim /etc/yum.repos.d/HDP.repo</span><br><span class="line"></span><br><span class="line"><span class="comment">#VERSION_NUMBER=3.1.0.0-78</span></span><br><span class="line">[HDP-3.1.0.0]</span><br><span class="line">name=HDP Version - HDP-3.1.0.0</span><br><span class="line">baseurl=http://hnode1/hdp/HDP/centos7</span><br><span class="line">gpgcheck=1</span><br><span class="line">gpgkey=http://hnode1/hdp/HDP/centos7/3.1.0.0-78/RPM-GPG-KEY/RPM-GPG-KEY-Jenkins</span><br><span class="line">enabled=1</span><br><span class="line">priority=1</span><br><span class="line"></span><br><span class="line">[HDP-UTILS-1.1.0.22]</span><br><span class="line">name=HDP-UTILS Version - HDP-UTILS-1.1.0.22</span><br><span class="line">baseurl=http://hnode1/hdp/HDP-UTILS-1.1.0.22</span><br><span class="line">gpgcheck=1</span><br><span class="line">gpgkey=http://hnode1/hdp/HDP-UTILS-1.1.0.22/HDP-UTILS/centos7/1.1.0.22/RPM-GPG-KEY/RPM-GPG-KEY-Jenkins</span><br><span class="line">enabled=1</span><br><span class="line">priority=1</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<h3 id="10-3-分发Ambari-repo和HDP-repo"><a href="#10-3-分发Ambari-repo和HDP-repo" class="headerlink" title="10.3 分发Ambari.repo和HDP.repo"></a>10.3 分发Ambari.repo和HDP.repo</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 把ambari.repo HDP.repo分发到各个节点的相同目录下</span></span><br><span class="line"></span><br><span class="line">[root@hnode1 opt] <span class="built_in">cd</span> /etc/yum.repos.d</span><br><span class="line">[root@hnode1 yum.repos.d] scp ambari.repo HDP.repo hnode2:<span class="variable">$PWD</span></span><br><span class="line">ambari.repo                                          100%  524   415.4KB/s   00:00</span><br><span class="line">HDP.repo                                             100%  469   227.5KB/s   00:00</span><br><span class="line">[root@hnode1 yum.repos.d] scp ambari.repo HDP.repo hnode3:<span class="variable">$PWD</span></span><br><span class="line">ambari.repo                                          100%  524   279.6KB/s   00:00</span><br><span class="line">HDP.repo                                             100%  469   295.9KB/s   00:00</span><br><span class="line">[root@hnode1 yum.repos.d]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># node2 查看文件是否成功分发</span></span><br><span class="line">[root@hnode2 yum.repos.d]# ll</span><br><span class="line">-rw-r--r--. 1 root root  524 3月  30 22:31 ambari.repo</span><br><span class="line">-rw-r--r--. 1 root root 1664 9月   5 2019 CentOS-Base.repo</span><br><span class="line">...</span><br><span class="line">-rw-r--r--. 1 root root  469 3月  30 22:31 HDP.repo</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># node3 查看文件是否成功分发</span></span><br><span class="line">[root@hnode3 yum.repos.d]# ll</span><br><span class="line">-rw-r--r--. 1 root root  524 3月  30 22:31 ambari.repo</span><br><span class="line">-rw-r--r--. 1 root root 1664 9月   5 2019 CentOS-Base.repo</span><br><span class="line">...</span><br><span class="line">-rw-r--r--. 1 root root  469 3月  30 22:31 HDP.repo</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<h3 id="10-4-生成本地源"><a href="#10-4-生成本地源" class="headerlink" title="10.4 生成本地源"></a>10.4 生成本地源</h3><p>使用createrepo命令，创建yum本地源（软件仓库），即为存放本地特定位置的众多rpm包建立索引，描述各包所需依赖信息，并形成元数据。</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@hnode1 yum.repos.d]# createrepo /var/www/html/hdp/HDP/centos7/</span><br><span class="line">Spawning worker 0 with 201 pkgs</span><br><span class="line">Workers Finished</span><br><span class="line">Saving Primary metadata</span><br><span class="line">Saving file lists metadata</span><br><span class="line">Saving other metadata</span><br><span class="line">Generating sqlite DBs</span><br><span class="line">Sqlite DBs complete</span><br><span class="line"></span><br><span class="line">[root@hnode1 yum.repos.d]# createrepo /var/www/html/hdp/HDP-UTILS-1.1.0.22/</span><br><span class="line">Spawning worker 0 with 16 pkgs</span><br><span class="line">Workers Finished</span><br><span class="line">Saving Primary metadata</span><br><span class="line">Saving file lists metadata</span><br><span class="line">Saving other metadata</span><br><span class="line">Generating sqlite DBs</span><br><span class="line">Sqlite DBs complete</span><br></pre></td></tr></tbody></table></figure>


<h2 id="11-安装Ambari-Server"><a href="#11-安装Ambari-Server" class="headerlink" title="11. 安装Ambari-Server"></a>11. 安装Ambari-Server</h2><h3 id="11-1-安装ambari-server"><a href="#11-1-安装ambari-server" class="headerlink" title="11.1 安装ambari-server"></a>11.1 安装ambari-server</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[root@hnode1 yum.repos.d]# yum install ambari-server</span><br><span class="line">已加载插件：fastestmirror</span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line"> * base: mirrors.aliyun.com</span><br><span class="line"> * extras: mirrors.aliyun.com</span><br><span class="line"> * updates: mirrors.aliyun.com</span><br><span class="line">ambari-2.7.3.0                                                            | 2.9 kB  00:00:00</span><br><span class="line">ambari-2.7.3.0/primary_db                                                 |  25 kB  00:00:00</span><br><span class="line">正在解决依赖关系</span><br><span class="line">--&gt; 正在检查事务</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">依赖关系解决</span><br><span class="line"></span><br><span class="line">============================================================================================</span><br><span class="line"> Package                   架构       版本                   源                        大小</span><br><span class="line">============================================================================================</span><br><span class="line">正在安装:</span><br><span class="line"> ambari-server             x86_64     2.7.3.0-139            ambari-2.7.3.0           352 M</span><br><span class="line">为依赖而安装:</span><br><span class="line"> postgresql                x86_64     9.2.24-2.el7_7         updates                  3.0 M</span><br><span class="line"> postgresql-libs           x86_64     9.2.24-2.el7_7         updates                  234 k</span><br><span class="line"> postgresql-server         x86_64     9.2.24-2.el7_7         updates                  3.8 M</span><br><span class="line"></span><br><span class="line">事务概要</span><br><span class="line">============================================================================================</span><br><span class="line">安装  1 软件包 (+3 依赖软件包)</span><br><span class="line">......</span><br><span class="line">(4/4): postgresql-server-9.2.24-2.el7_7.x86_64.rpm                        | 3.8 MB  00:00:05</span><br><span class="line">--------------------------------------------------------------------------------------------</span><br><span class="line">总计                                                               57 MB/s | 359 MB  00:00:06</span><br><span class="line">从 http://hnode1/ambari/ambari/centos7/2.7.3.0-139/RPM-GPG-KEY/RPM-GPG-KEY-Jenkin 检索密钥</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">获取 GPG 密钥失败：[Errno 14] HTTP Error 404 - Not Found</span><br><span class="line">[root@hnode1 yum.repos.d]# vim ambari.repo</span><br><span class="line">[root@hnode1 yum.repos.d]#</span><br><span class="line">[root@hnode1 yum.repos.d]#</span><br><span class="line">[root@hnode1 yum.repos.d]#</span><br><span class="line">[root@hnode1 yum.repos.d]# yum install ambari-server</span><br><span class="line">已加载插件：fastestmirror</span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line"> * base: mirrors.aliyun.com</span><br><span class="line"> * extras: mirrors.aliyun.com</span><br><span class="line"> * updates: mirrors.aliyun.com</span><br><span class="line">ambari-2.7.3.0                                                            | 2.9 kB  00:00:00</span><br><span class="line">正在解决依赖关系</span><br><span class="line">--&gt; 正在检查事务</span><br><span class="line">---&gt; 软件包 ambari-server.x86_64.0.2.7.3.0-139 将被 安装</span><br><span class="line">--&gt; 正在处理依赖关系 postgresql-server &gt;= 8.1，它被软件包 ambari-server-2.7.3.0-139.x86_64 需要</span><br><span class="line">--&gt; 正在检查事务</span><br><span class="line">...</span><br><span class="line">--&gt; 解决依赖关系完成</span><br><span class="line"></span><br><span class="line">依赖关系解决</span><br><span class="line"></span><br><span class="line">=================================================================================================</span><br><span class="line"> Package                    架构        版本                   源                           大小</span><br><span class="line">=================================================================================================</span><br><span class="line">正在安装:</span><br><span class="line"> ambari-server              x86_64      2.7.3.0-139            ambari-2.7.3.0              352 M</span><br><span class="line">为依赖而安装:</span><br><span class="line"> postgresql                 x86_64      9.2.24-2.el7_7         updates                     3.0 M</span><br><span class="line"> postgresql-libs            x86_64      9.2.24-2.el7_7         updates                     234 k</span><br><span class="line"> postgresql-server          x86_64      9.2.24-2.el7_7         updates                     3.8 M</span><br><span class="line"></span><br><span class="line">事务概要</span><br><span class="line">=================================================================================================</span><br><span class="line">安装  1 软件包 (+3 依赖软件包)</span><br><span class="line"></span><br><span class="line">总计：359 M</span><br><span class="line">安装大小：451 M</span><br><span class="line">Is this ok [y/d/N]: y</span><br><span class="line">...</span><br><span class="line">是否继续？[y/N]：y</span><br><span class="line">Running transaction check</span><br><span class="line">Running transaction <span class="built_in">test</span></span><br><span class="line">Transaction <span class="built_in">test</span> succeeded</span><br><span class="line">Running transaction</span><br><span class="line">  正在安装    : postgresql-libs-9.2.24-2.el7_7.x86_64                                 1/4</span><br><span class="line">  正在安装    : postgresql-9.2.24-2.el7_7.x86_64                                      2/4</span><br><span class="line">  正在安装    : postgresql-server-9.2.24-2.el7_7.x86_64                               3/4</span><br><span class="line">  正在安装    : ambari-server-2.7.3.0-139.x86_64                                      4/4</span><br><span class="line">  验证中      : postgresql-server-9.2.24-2.el7_7.x86_64                               1/4</span><br><span class="line">  验证中      : ambari-server-2.7.3.0-139.x86_64                                      2/4</span><br><span class="line">  验证中      : postgresql-libs-9.2.24-2.el7_7.x86_64                                 3/4</span><br><span class="line">  验证中      : postgresql-9.2.24-2.el7_7.x86_64                                      4/4</span><br><span class="line"></span><br><span class="line">已安装:</span><br><span class="line">  ambari-server.x86_64 0:2.7.3.0-139</span><br><span class="line">...</span><br><span class="line">完毕！</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<h3 id="11-2-配置ambari-server"><a href="#11-2-配置ambari-server" class="headerlink" title="11.2 配置ambari-server"></a>11.2 配置ambari-server</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">[root@hnode1 ~]# ambari-server setup</span><br><span class="line">Using python  /usr/bin/python</span><br><span class="line">Setup ambari-server</span><br><span class="line">Checking SELinux...</span><br><span class="line">SELinux status is <span class="string">'disabled'</span></span><br><span class="line">Customize user account <span class="keyword">for</span> ambari-server daemon [y/n] (n)? y</span><br><span class="line">Enter user account <span class="keyword">for</span> ambari-server daemon (root):root</span><br><span class="line">Adjusting ambari-server permissions and ownership...</span><br><span class="line">Checking firewall status...</span><br><span class="line">Checking JDK...</span><br><span class="line">[1] Oracle JDK 1.8 + Java Cryptography Extension (JCE) Policy Files 8</span><br><span class="line">[2] Custom JDK</span><br><span class="line">==============================================================================</span><br><span class="line">Enter choice (1): 2 <span class="comment">#选择自定义jdk</span></span><br><span class="line">WARNING: JDK must be installed on all hosts and JAVA_HOME must be valid on all hosts.</span><br><span class="line">WARNING: JCE Policy files are required <span class="keyword">for</span> configuring Kerberos security. If you plan </span><br><span class="line">to use Kerberos,please make sure JCE Unlimited Strength Jurisdiction Policy Files are valid on all hosts.</span><br><span class="line">Path to JAVA_HOME: /opt/jdk1.8.0_191 <span class="comment">#JAVA_HOME</span></span><br><span class="line">Validating JDK on Ambari Server...<span class="keyword">done</span>.</span><br><span class="line">Check JDK version <span class="keyword">for</span> Ambari Server...</span><br><span class="line">JDK version found: 8</span><br><span class="line">Minimum JDK version is 8 <span class="keyword">for</span> Ambari. Skipping to setup different JDK <span class="keyword">for</span> Ambari Server.</span><br><span class="line">Checking GPL software agreement...</span><br><span class="line">GPL License <span class="keyword">for</span> LZO: https://www.gnu.org/licenses/old-licenses/gpl-2.0.en.html</span><br><span class="line">Enable Ambari Server to download and install GPL Licensed LZO packages [y/n] (n)? y</span><br><span class="line">Completing setup...</span><br><span class="line">Configuring database...</span><br><span class="line">Enter advanced database configuration [y/n] (n)? y <span class="comment">#配置数据库</span></span><br><span class="line">Configuring database...</span><br><span class="line">==============================================================================</span><br><span class="line">Choose one of the following options:</span><br><span class="line">[1] - PostgreSQL (Embedded)</span><br><span class="line">[2] - Oracle</span><br><span class="line">[3] - MySQL / MariaDB</span><br><span class="line">[4] - PostgreSQL</span><br><span class="line">[5] - Microsoft SQL Server (Tech Preview)</span><br><span class="line">[6] - SQL Anywhere</span><br><span class="line">[7] - BDB</span><br><span class="line">==============================================================================</span><br><span class="line">Enter choice (1): 3</span><br><span class="line">Hostname (localhost): hnode1 <span class="comment">#mysql hostname</span></span><br><span class="line">Port (3306): <span class="comment"># mysql 端口 默认 3306</span></span><br><span class="line">Database name (ambari): <span class="comment">#使用的数据库名称</span></span><br><span class="line">Username (ambari): <span class="comment">#mysql用户名</span></span><br><span class="line">Enter Database Password (bigdata): <span class="comment">#密码 前面增加的ambari用户的密码 （Ambari123）</span></span><br><span class="line">Re-enter password: <span class="comment">#（Ambari123）</span></span><br><span class="line">Passwords <span class="keyword">do</span> not match</span><br><span class="line">Enter Database Password (bigdata):</span><br><span class="line">Invalid characters <span class="keyword">in</span> password. Use only alphanumeric or _ or - characters</span><br><span class="line">Enter Database Password (bigdata):</span><br><span class="line">Re-enter password:</span><br><span class="line">Configuring ambari database...</span><br><span class="line">Should ambari use existing default jdbc /usr/share/java/mysql-connector-java.jar [y/n] (y)? y</span><br><span class="line">Configuring remote database connection properties...</span><br><span class="line">WARNING: Before starting Ambari Server, you must run the following DDL directly </span><br><span class="line">from the database shell to create the schema: /var/lib/ambari-server/resources/Ambari-DDL-MySQL-CREATE.sql</span><br><span class="line">Proceed with configuring remote database connection properties [y/n] (y)? y</span><br><span class="line">Extracting system views...</span><br><span class="line">ambari-admin-2.7.3.0.139.jar</span><br><span class="line">....</span><br><span class="line">Ambari repo file contains latest json url http://public-repo-1.hortonworks.com/HDP/hdp_urlinfo.json, </span><br><span class="line">   updating stacks repoinfos with it...</span><br><span class="line">Adjusting ambari-server permissions and ownership...</span><br><span class="line">Ambari Server <span class="string">'setup'</span> completed successfully.</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<h3 id="11-3-登录MySQL创建执行建表脚本"><a href="#11-3-登录MySQL创建执行建表脚本" class="headerlink" title="11.3 登录MySQL创建执行建表脚本"></a>11.3 登录MySQL创建执行建表脚本</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[root@hnode1 ~]# mysql -u ambari -p -h hnode1</span><br><span class="line">Enter password:</span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">...</span><br><span class="line">mysql&gt; use ambari;</span><br><span class="line">Database changed</span><br><span class="line">mysql&gt; show tables;</span><br><span class="line">Empty <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"><span class="comment"># 执行 Ambari-DDL-MySQL-CREATE.sql 脚本</span></span><br><span class="line">mysql&gt; <span class="built_in">source</span> /var/lib/ambari-server/resources/Ambari-DDL-MySQL-CREATE.sql;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 有无报错信息 查看创建的表</span></span><br><span class="line">mysql&gt; show tables;</span><br><span class="line">+-------------------------------+</span><br><span class="line">| Tables_in_ambari              |</span><br><span class="line">+-------------------------------+</span><br><span class="line">| ClusterHostMapping            |</span><br><span class="line">| QRTZ_BLOB_TRIGGERS            |</span><br><span class="line">| QRTZ_CALENDARS                |</span><br><span class="line">| QRTZ_CRON_TRIGGERS            |</span><br><span class="line">| QRTZ_FIRED_TRIGGERS           |</span><br><span class="line">| QRTZ_JOB_DETAILS              |</span><br><span class="line">| QRTZ_LOCKS                    |</span><br><span class="line">| QRTZ_PAUSED_TRIGGER_GRPS      |</span><br><span class="line">| QRTZ_SCHEDULER_STATE          |</span><br><span class="line">| QRTZ_SIMPLE_TRIGGERS          |</span><br><span class="line">| QRTZ_SIMPROP_TRIGGERS         |</span><br><span class="line">| QRTZ_TRIGGERS                 |</span><br><span class="line">| adminpermission               |</span><br><span class="line">| adminprincipal                |</span><br><span class="line">| adminprincipaltype            |</span><br><span class="line">| adminprivilege                |</span><br><span class="line">| adminresource                 |</span><br><span class="line">| adminresourcetype             |</span><br><span class="line">| alert_current                 |</span><br><span class="line">| alert_definition              |</span><br><span class="line">| alert_group                   |</span><br><span class="line">| alert_group_target            |</span><br><span class="line">| alert_grouping                |</span><br><span class="line">| alert_history                 |</span><br><span class="line">| alert_notice                  |</span><br><span class="line">| alert_target                  |</span><br><span class="line">| alert_target_states           |</span><br><span class="line">| ambari_configuration          |</span><br><span class="line">| ambari_operation_history      |</span><br><span class="line">| ambari_sequences              |</span><br><span class="line">| artifact                      |</span><br><span class="line">| blueprint                     |</span><br><span class="line">| blueprint_configuration       |</span><br><span class="line">| blueprint_setting             |</span><br><span class="line">| clusterconfig                 |</span><br><span class="line">| clusters                      |</span><br><span class="line">| clusterservices               |</span><br><span class="line">| clusterstate                  |</span><br><span class="line">| confgroupclusterconfigmapping |</span><br><span class="line">| configgroup                   |</span><br><span class="line">| configgrouphostmapping        |</span><br><span class="line">| execution_command             |</span><br><span class="line">| extension                     |</span><br><span class="line">| extensionlink                 |</span><br><span class="line">| <span class="built_in">groups</span>                        |</span><br><span class="line">| host_role_command             |</span><br><span class="line">| host_version                  |</span><br><span class="line">| hostcomponentdesiredstate     |</span><br><span class="line">| hostcomponentstate            |</span><br><span class="line">| hostconfigmapping             |</span><br><span class="line">| hostgroup                     |</span><br><span class="line">| hostgroup_component           |</span><br><span class="line">| hostgroup_configuration       |</span><br><span class="line">| hosts                         |</span><br><span class="line">| hoststate                     |</span><br><span class="line">| kerberos_descriptor           |</span><br><span class="line">| kerberos_keytab               |</span><br><span class="line">| kerberos_keytab_principal     |</span><br><span class="line">| kerberos_principal            |</span><br><span class="line">| key_value_store               |</span><br><span class="line">| kkp_mapping_service           |</span><br><span class="line">| members                       |</span><br><span class="line">| metainfo                      |</span><br><span class="line">| permission_roleauthorization  |</span><br><span class="line">| remoteambaricluster           |</span><br><span class="line">| remoteambariclusterservice    |</span><br><span class="line">| repo_applicable_services      |</span><br><span class="line">| repo_definition               |</span><br><span class="line">| repo_os                       |</span><br><span class="line">| repo_tags                     |</span><br><span class="line">| repo_version                  |</span><br><span class="line">| request                       |</span><br><span class="line">| requestoperationlevel         |</span><br><span class="line">| requestresourcefilter         |</span><br><span class="line">| requestschedule               |</span><br><span class="line">| requestschedulebatchrequest   |</span><br><span class="line">| role_success_criteria         |</span><br><span class="line">| roleauthorization             |</span><br><span class="line">| servicecomponent_version      |</span><br><span class="line">| servicecomponentdesiredstate  |</span><br><span class="line">| serviceconfig                 |</span><br><span class="line">| serviceconfighosts            |</span><br><span class="line">| serviceconfigmapping          |</span><br><span class="line">| servicedesiredstate           |</span><br><span class="line">| setting                       |</span><br><span class="line">| stack                         |</span><br><span class="line">| stage                         |</span><br><span class="line">| topology_host_info            |</span><br><span class="line">| topology_host_request         |</span><br><span class="line">| topology_host_task            |</span><br><span class="line">| topology_hostgroup            |</span><br><span class="line">| topology_logical_request      |</span><br><span class="line">| topology_logical_task         |</span><br><span class="line">| topology_request              |</span><br><span class="line">| upgrade                       |</span><br><span class="line">| upgrade_group                 |</span><br><span class="line">| upgrade_history               |</span><br><span class="line">| upgrade_item                  |</span><br><span class="line">| user_authentication           |</span><br><span class="line">| <span class="built_in">users</span>                         |</span><br><span class="line">| viewentity                    |</span><br><span class="line">| viewinstance                  |</span><br><span class="line">| viewinstancedata              |</span><br><span class="line">| viewinstanceproperty          |</span><br><span class="line">| viewmain                      |</span><br><span class="line">| viewparameter                 |</span><br><span class="line">| viewresource                  |</span><br><span class="line">| viewurl                       |</span><br><span class="line">| widget                        |</span><br><span class="line">| widget_layout                 |</span><br><span class="line">| widget_layout_user_widget     |</span><br><span class="line">+-------------------------------+</span><br><span class="line">111 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<h3 id="11-4-启动Ambari-Server"><a href="#11-4-启动Ambari-Server" class="headerlink" title="11.4 启动Ambari-Server"></a>11.4 启动Ambari-Server</h3><table>
<thead>
<tr>
<th>功能</th>
<th>命令</th>
</tr>
</thead>
<tbody><tr>
<td>启动命令</td>
<td>ambari-server start</td>
</tr>
<tr>
<td>停止命令</td>
<td>ambari-server stop</td>
</tr>
<tr>
<td>查看状态</td>
<td>ambari-server status</td>
</tr>
<tr>
<td>重启命令</td>
<td>ambari-server restart</td>
</tr>
</tbody></table>
<ul>
<li>ambari-server<ul>
<li>start</li>
<li>stop</li>
<li>reset</li>
<li>restart</li>
<li>upgrade</li>
<li>status</li>
<li>upgradestack</li>
<li>setup</li>
<li>setup-jce</li>
<li>setup-ldap</li>
<li>sync-ldap</li>
<li>set-current</li>
<li>setup-security</li>
<li>refresh-stack-hash</li>
<li>backup</li>
<li>restore</li>
<li>update-host-names</li>
<li>check-database</li>
<li>enable-stack</li>
<li>setup-sso</li>
<li>db-purge-history</li>
<li>install-mpack</li>
<li>uninstall-mpack</li>
<li>upgrade-mpack</li>
<li>setup-kerberos</li>
<li>setup-pam</li>
<li>migrate-ldap-pam</li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@hnode1 ~]# ambari-server start</span><br><span class="line"><span class="comment"># 如果启动失败，关闭服务【ambari-server stop】，重新启动</span></span><br><span class="line">Using python  /usr/bin/python</span><br><span class="line">Starting ambari-server</span><br><span class="line">Ambari Server running with administrator privileges.</span><br><span class="line">Organizing resource files at /var/lib/ambari-server/resources...</span><br><span class="line">Ambari database consistency check started...</span><br><span class="line">Server PID at: /var/run/ambari-server/ambari-server.pid</span><br><span class="line">Server out at: /var/log/ambari-server/ambari-server.out</span><br><span class="line">Server <span class="built_in">log</span> at: /var/log/ambari-server/ambari-server.log</span><br><span class="line">Waiting <span class="keyword">for</span> server start.........................................</span><br><span class="line">Server started listening on 8080</span><br><span class="line"></span><br><span class="line">DB configs consistency check: no errors and warnings were found.</span><br><span class="line">Ambari Server <span class="string">'start'</span> completed successfully.</span><br></pre></td></tr></tbody></table></figure>

<p><a target="_blank" rel="noopener" href="http://hnode1:8080/">http://hnode1:8080</a><br><img src="https://images.hnbian.cn/FoG2Bf9FIQXimUeyS9NZ67IvtUjj?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="Ambari 登录页"></p>
<h3 id="11-5-安装Agent"><a href="#11-5-安装Agent" class="headerlink" title="11.5 安装Agent"></a>11.5 安装Agent</h3><table>
<thead>
<tr>
<th>功能</th>
<th>命令</th>
</tr>
</thead>
<tbody><tr>
<td>启动命令</td>
<td>service ambari-agent start</td>
</tr>
<tr>
<td>停止命令</td>
<td>service ambari-agent stop</td>
</tr>
<tr>
<td>查看状态</td>
<td>service ambari-agent status</td>
</tr>
<tr>
<td>重启命令</td>
<td>service ambari-agent restart</td>
</tr>
</tbody></table>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在每个计算节点都要安装 agent</span></span><br><span class="line"></span><br><span class="line">[root@hnode1 ~]# yum -y install ambari-agent</span><br><span class="line">已加载插件：fastestmirror</span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line"> * base: mirrors.aliyun.com</span><br><span class="line"> * extras: mirrors.aliyun.com</span><br><span class="line"> * updates: mirrors.aliyun.com</span><br><span class="line">HDP-3.1.0.0                                                 | 2.9 kB  00:00:00</span><br><span class="line">HDP-UTILS-1.1.0.22                                          | 2.9 kB  00:00:00</span><br><span class="line">ambari-2.7.3.0                                              | 2.9 kB  00:00:00</span><br><span class="line">base                                                        | 3.6 kB  00:00:00</span><br><span class="line">extras                                                      | 2.9 kB  00:00:00</span><br><span class="line">mysql-connectors-community                                  | 2.5 kB  00:00:00</span><br><span class="line">mysql-tools-community                                       | 2.5 kB  00:00:00</span><br><span class="line">mysql57-community                                           | 2.5 kB  00:00:00</span><br><span class="line">updates                                                     | 2.9 kB  00:00:00</span><br><span class="line">正在解决依赖关系</span><br><span class="line">--&gt; 正在检查事务</span><br><span class="line">---&gt; 软件包 ambari-agent.x86_64.0.2.7.3.0-139 将被 安装</span><br><span class="line">--&gt; 解决依赖关系完成</span><br><span class="line"></span><br><span class="line">依赖关系解决</span><br><span class="line"></span><br><span class="line">=================================================================================</span><br><span class="line"> Package            架构          版本               源                     大小</span><br><span class="line">=================================================================================</span><br><span class="line">正在安装:</span><br><span class="line"> ambari-agent       x86_64        2.7.3.0-139        ambari-2.7.3.0         36 M</span><br><span class="line"></span><br><span class="line">事务概要</span><br><span class="line">=================================================================================</span><br><span class="line">安装  1 软件包</span><br><span class="line"></span><br><span class="line">总下载量：36 M</span><br><span class="line">安装大小：68 M</span><br><span class="line">Downloading packages:</span><br><span class="line">ambari-agent-2.7.3.0-139.x86_64.rpm                           |  36 MB  00:00:00</span><br><span class="line">Running transaction check</span><br><span class="line">Running transaction <span class="built_in">test</span></span><br><span class="line">Transaction <span class="built_in">test</span> succeeded</span><br><span class="line">Running transaction</span><br><span class="line">  正在安装    : ambari-agent-2.7.3.0-139.x86_64                                1/1</span><br><span class="line">  验证中      : ambari-agent-2.7.3.0-139.x86_64                                1/1</span><br><span class="line"></span><br><span class="line">已安装:</span><br><span class="line">  ambari-agent.x86_64 0:2.7.3.0-139</span><br><span class="line"></span><br><span class="line">完毕！</span><br></pre></td></tr></tbody></table></figure>

<h2 id="12-集群安装"><a href="#12-集群安装" class="headerlink" title="12. 集群安装"></a>12. 集群安装</h2><p><img src="https://images.hnbian.cn/FlOAKZlR0xsux6Xkj3gQhUg-Eaqt?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="启用安装向导创建集群"></p>
<p><img src="https://images.hnbian.cn/Fpdvb-0RLKBiL95InN532ADLJaCX?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="配置集群名称"></p>
<p><img src="https://images.hnbian.cn/Fj_0pVRyJgpLQB-enRiYB_CYaYlR?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="选择版本,配置仓库地址"></p>
<ul>
<li><a target="_blank" rel="noopener" href="http://hnode1/hdp/HDP/centos7/">http://hnode1/hdp/HDP/centos7/</a></li>
<li><a target="_blank" rel="noopener" href="http://public-repo-1.hortonworks.com/HDP-GPL/centos7/3.x/updates/3.1.0.0">http://public-repo-1.hortonworks.com/HDP-GPL/centos7/3.x/updates/3.1.0.0</a></li>
<li><a target="_blank" rel="noopener" href="http://hnode1/hdp/HDP-UTILS-1.1.0.22/">http://hnode1/hdp/HDP-UTILS-1.1.0.22/</a></li>
</ul>
<p><img src="https://images.hnbian.cn/FgnzlsjfYvhEVM1Uk0VLpxxaVch4?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="配置集群节点与秘钥"></p>
<p><img src="https://images.hnbian.cn/Fk2VS74xQRZzpzuoCv-Ue9dMueuU?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="确认主机"></p>
<p>这个步骤可能会出现如下错误:</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ERROR 2020-04-05 15:04:48,778 main.py:269 - Ambari agent machine hostname (localhost.localdomain) does not match expected ambari server hostname (hnode1). Aborting registration. Please check hostname, hostname -f and /etc/hosts file to confirm your hostname is setup correctly</span><br><span class="line"></span><br><span class="line"><span class="comment"># 请检查hostname的配置</span></span><br></pre></td></tr></tbody></table></figure>



<p><img src="https://images.hnbian.cn/Fsw8GDX3e23TPpI0A6VscoIOFf80?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="选择要安装的组件"></p>
<p>如果某个服务A 依赖服务B，而你没有选择安装服务B， 会提示安装服务B</p>
<p><img src="https://images.hnbian.cn/FliY60yTnxJ8Q-iNBI_b2ZN84Ai2?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="节点服务分配"></p>
<p><img src="https://images.hnbian.cn/Fs9DjR0cEEb7RAIkktGiEBWdARML?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="分配Slaves 和 Clients"></p>
<p><img src="https://images.hnbian.cn/Fq8q70BlNIAr0tNBwtv0A_pZTQW_?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="定制服务，配置用户密码"></p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@hnode1 .ssh]# ambari-server setup --jdbc-db=mysql --jdbc-driver=/usr/share/java/mysql-connector-java.jar</span><br><span class="line">Using python  /usr/bin/python</span><br><span class="line">Setup ambari-server</span><br><span class="line">Copying /usr/share/java/mysql-connector-java.jar to /var/lib/ambari-server/resources/mysql-connector-java.jar</span><br><span class="line">If you are updating existing jdbc driver jar <span class="keyword">for</span> mysql with mysql-connector-java.jar. Please remove the old driver jar, </span><br><span class="line"> from all hosts. Restarting services that need the driver, will automatically copy the new jar to the hosts.</span><br><span class="line">JDBC driver was successfully initialized.</span><br><span class="line">Ambari Server <span class="string">'setup'</span> completed successfully.</span><br></pre></td></tr></tbody></table></figure>

<p><img src="https://images.hnbian.cn/Fm7pVv6gaqanr4LXHtyRwBWTtT_8?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="定制服务，相关路径配置"></p>
<p><img src="https://images.hnbian.cn/Fpx8gO3slnv-F1aoT6pv0tDXQYHp?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="定制服务，用户配置"></p>
<p><img src="https://images.hnbian.cn/Fvlg62s4eLloysRzQARcfsplfvty?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="定制服务，资源配置"></p>
<p><img src="https://images.hnbian.cn/Fl33w-pC2sk_XYprV4evZpV9fIIw?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="查看概况，部署服务"></p>
<p><img src="https://images.hnbian.cn/FqzsW1Xw_y6ETX2OzpWgKZ6WXsIc?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="安装完成"></p>
<p>有些警告可以在后面调整集群</p>
<p><img src="https://images.hnbian.cn/FlislZiU8iBem1ybuvTF-3HSuY2Z?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="安装完成，概览安装的服务"></p>
<p><img src="https://images.hnbian.cn/Fh2OWFNJNxJdEiSedt9SrIXY2F8K" alt="监视页面"></p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">hnbian</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://www.hnbian.cn/posts/f09c2b77.html">https://www.hnbian.cn/posts/f09c2b77.html</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">hnbian</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/ambari/">
                                    <span class="chip bg-color">ambari</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    
        <style>
    .valine-card {
        margin: 1.5rem auto;
    }

    .valine-card .card-content {
        padding: 20px 20px 5px 20px;
    }

    #vcomments textarea {
        box-sizing: border-box;
        background: url("/medias/comment_bg.png") 100% 100% no-repeat;
    }

    #vcomments p {
        margin: 2px 2px 10px;
        font-size: 1.05rem;
        line-height: 1.78rem;
    }

    #vcomments blockquote p {
        text-indent: 0.2rem;
    }

    #vcomments a {
        padding: 0 2px;
        color: #4cbf30;
        font-weight: 500;
        text-decoration: none;
    }

    #vcomments img {
        max-width: 100%;
        height: auto;
        cursor: pointer;
    }

    #vcomments ol li {
        list-style-type: decimal;
    }

    #vcomments ol,
    ul {
        display: block;
        padding-left: 2em;
        word-spacing: 0.05rem;
    }

    #vcomments ul li,
    ol li {
        display: list-item;
        line-height: 1.8rem;
        font-size: 1rem;
    }

    #vcomments ul li {
        list-style-type: disc;
    }

    #vcomments ul ul li {
        list-style-type: circle;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    #vcomments table, th, td {
        border: 0;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments h1 {
        font-size: 1.85rem;
        font-weight: bold;
        line-height: 2.2rem;
    }

    #vcomments h2 {
        font-size: 1.65rem;
        font-weight: bold;
        line-height: 1.9rem;
    }

    #vcomments h3 {
        font-size: 1.45rem;
        font-weight: bold;
        line-height: 1.7rem;
    }

    #vcomments h4 {
        font-size: 1.25rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    #vcomments h5 {
        font-size: 1.1rem;
        font-weight: bold;
        line-height: 1.4rem;
    }

    #vcomments h6 {
        font-size: 1rem;
        line-height: 1.3rem;
    }

    #vcomments p {
        font-size: 1rem;
        line-height: 1.5rem;
    }

    #vcomments hr {
        margin: 12px 0;
        border: 0;
        border-top: 1px solid #ccc;
    }

    #vcomments blockquote {
        margin: 15px 0;
        border-left: 5px solid #42b983;
        padding: 1rem 0.8rem 0.3rem 0.8rem;
        color: #666;
        background-color: rgba(66, 185, 131, .1);
    }

    #vcomments pre {
        font-family: monospace, monospace;
        padding: 1.2em;
        margin: .5em 0;
        background: #272822;
        overflow: auto;
        border-radius: 0.3em;
        tab-size: 4;
    }

    #vcomments code {
        font-family: monospace, monospace;
        padding: 1px 3px;
        font-size: 0.92rem;
        color: #e96900;
        background-color: #f8f8f8;
        border-radius: 2px;
    }

    #vcomments pre code {
        font-family: monospace, monospace;
        padding: 0;
        color: #e8eaf6;
        background-color: #272822;
    }

    #vcomments pre[class*="language-"] {
        padding: 1.2em;
        margin: .5em 0;
    }

    #vcomments code[class*="language-"],
    pre[class*="language-"] {
        color: #e8eaf6;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }

    #vcomments b,
    strong {
        font-weight: bold;
    }

    #vcomments dfn {
        font-style: italic;
    }

    #vcomments small {
        font-size: 85%;
    }

    #vcomments cite {
        font-style: normal;
    }

    #vcomments mark {
        background-color: #fcf8e3;
        padding: .2em;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }
</style>

<div class="card valine-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; padding-left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>评论</span>
    </div>
    <div id="vcomments" class="card-content" style="display: grid">
    </div>
</div>

<script src="/libs/valine/av-min.js"></script>
<script src="/libs/valine/Valine.min.js"></script>
<script>
    new Valine({
        el: '#vcomments',
        appId: 'h1rND3bHC0OqFwzm1UfPQpaY-gzGzoHsz',
        appKey: 'd7uboDt2WLV2HJCEMHkkLuU4',
        serverURLs: '',
        notify: 'false' === 'true',
        verify: 'false' === 'true',
        visitor: 'true' === 'true',
        avatar: 'identicon',
        pageSize: '12',
        lang: 'zh-cn',
        placeholder: 'just go go'
    });
</script>

<!--酷Q推送-->


    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/posts/e3f2dd8c.html">
                    <div class="card-image">
                        
                        <img src="https://images.hnbian.cn/FmR6s8_bvNEgKbWJ3i9XeQxnr0uu" class="responsive-img" alt="JVM系列（七）、不同的引用类型">
                        
                        <span class="card-title">JVM系列（七）、不同的引用类型</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2020-03-15
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/java/" class="post-category">
                                    java
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/java/">
                        <span class="chip bg-color">java</span>
                    </a>
                    
                    <a href="/tags/jvm/">
                        <span class="chip bg-color">jvm</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/posts/77e7a883.html">
                    <div class="card-image">
                        
                        <img src="https://images.hnbian.cn/FjiMWJ33LzWghQ2Ej7iqT_zXuXID" class="responsive-img" alt="Kafka总结（七）Kafka监控kafka-manager介绍">
                        
                        <span class="card-title">Kafka总结（七）Kafka监控kafka-manager介绍</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2020-02-23
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/kafka/" class="post-category">
                                    kafka
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/kafka/">
                        <span class="chip bg-color">kafka</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('120')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE' || selection.getRangeAt(0).commonAncestorContainer.nodeName === 'CODE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + '来源: hnbian<br />'
            + '文章作者: hnbian<br />'
            + '文章链接: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>


<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>



<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4, h5'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    

    <div class="container row center-align"
         style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2018-2025</span>
            
            <a href="/about" target="_blank">hnbian</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            
                <span id="translate">|&nbsp;繁/简：</span><a id="translateLink" href="javascript:translatePage();">繁</a>
            
            <br>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
                <span id="sitetime"> Loading ...</span>
                <script>
                    var calcSiteTime = function () {
                        var seconds = 1000;
                        var minutes = seconds * 60;
                        var hours = minutes * 60;
                        var days = hours * 24;
                        var years = days * 365;
                        var today = new Date();
                        var startYear = "2018";
                        var startMonth = "2";
                        var startDate = "8";
                        var startHour = "0";
                        var startMinute = "0";
                        var startSecond = "0";
                        var todayYear = today.getFullYear();
                        var todayMonth = today.getMonth() + 1;
                        var todayDate = today.getDate();
                        var todayHour = today.getHours();
                        var todayMinute = today.getMinutes();
                        var todaySecond = today.getSeconds();
                        var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                        var diff = t2 - t1;
                        var diffYears = Math.floor(diff / years);
                        var diffDays = Math.floor((diff / days) - diffYears * 365);

                        // 区分是否有年份.
                        var language = 'zh-CN';
                        if (startYear === String(todayYear)) {
                            document.getElementById("year").innerHTML = todayYear;
                            var daysTip = 'This site has been running for ' + diffDays + ' days';
                            if (language === 'zh-CN') {
                                daysTip = '本站已运行 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                daysTip = '本站已運行 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = daysTip;
                        } else {
                            document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                            var yearsAndDaysTip = 'This site has been running for ' + diffYears + ' years and '
                                + diffDays + ' days';
                            if (language === 'zh-CN') {
                                yearsAndDaysTip = '本站已运行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                yearsAndDaysTip = '本站已運行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = yearsAndDaysTip;
                        }
                    }

                    calcSiteTime();
                </script>
            
            <br>
            
                <span id="icp"><img src="/medias/icp.png"
                                    style="vertical-align: text-bottom;"/>
                <a href="https://beian.miit.gov.cn" target="_blank">粤ICP备18156920号-2</a>
            </span>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/hnbian" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:hnbian@126.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>













</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    
        <script type="text/javascript" src="/js/tw_cn.js"></script>
        <script type="text/javascript">
          var defaultEncoding = 2; //网站编写字体是否繁体，1-繁体，2-简体
          var translateDelay = 0; //延迟时间,若不在前, 要设定延迟翻译时间, 如100表示100ms,默认为0
          var cookieDomain = "https://www.hnbian.cn"; //Cookie地址, 一定要设定, 通常为你的网址
          var msgToTraditionalChinese = "繁"; //此处可以更改为你想要显示的文字
          var msgToSimplifiedChinese = "简"; //同上，但两处均不建议更改
          var translateButtonId = "translateLink"; //默认互换id
          translateInitilization();
        </script>
    
    
    

    <!-- 雪花特效 -->
     
        <script type="text/javascript">
            // 只在桌面版网页启用特效
            var windowWidth = $(window).width();
            if (windowWidth > 768) {
                document.write('<script type="text/javascript" src="/libs/others/snow.js"><\/script>');
            }
        </script>
    

    <!-- 鼠标星星特效 -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
